<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Giftup Online üöÄ</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        :root { --blue: #007aff; --green: #34c759; --red: #ff3b30; --bg: #000; --panel: #1c1c1e; }
        body { background: var(--bg); color: white; font-family: -apple-system, sans-serif; margin: 0; padding-bottom: 50px; }
        
        .header { padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #222; position: sticky; top: 0; background: #000; z-index: 100; }
        .balance { background: var(--green); color: black; padding: 6px 15px; border-radius: 20px; font-weight: 800; font-size: 14px; }

        .tabs { display: flex; gap: 10px; padding: 15px; }
        .tab { flex: 1; padding: 12px; background: #1c1c1e; border-radius: 10px; text-align: center; font-weight: bold; cursor: pointer; border: 1px solid #333; }
        .tab.active { background: #333; border-color: var(--blue); }

        .game-container { display: none; padding: 10px; }
        .game-container.active { display: block; }

        /* Rocket UI */
        .viewport { height: 250px; position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden; background: #050505; border-radius: 15px; margin-bottom: 15px; }
        #rocket-vid { width: 180px; position: absolute; bottom: -200px; transition: transform 0.4s, opacity 0.3s; }
        .mult { font-size: 42px; font-weight: 900; z-index: 10; text-shadow: 0 0 20px rgba(0,0,0,0.5); }

        /* Mines UI */
        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-bottom: 15px; }
        .cell { aspect-ratio: 1; background: #2c2c2e; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 24px; transition: 0.2s; }
        .cell.open { background: #3a3a3c; }

        .controls { background: #111; padding: 20px; border-radius: 20px; border: 1px solid #222; }
        input { width: 100%; background: #1c1c1e; border: 1px solid #333; border-radius: 12px; padding: 15px; color: white; font-size: 18px; box-sizing: border-box; margin-bottom: 15px; outline: none; }
        .btn { width: 100%; padding: 18px; border-radius: 15px; border: none; font-size: 18px; font-weight: 800; color: white; cursor: pointer; }
        
        .history-title { font-size: 12px; color: #555; margin: 15px 0 10px; padding-left: 5px; }
        .bet-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #111; font-size: 14px; }
    </style>
</head>
<body>

    <div class="header">
        <span>@tg_player</span>
        <div class="balance"><span class="bal-txt">500.00</span> ‚Ç¥</div>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="switchGame('rocket')">ROCKET</div>
        <div class="tab" onclick="switchGame('mines')">MINES</div>
    </div>

    <div id="rocket-game" class="game-container active">
        <div class="viewport">
            <div id="r-mult" class="mult">5.00s</div>
            <video id="rocket-vid" playsinline muted loop>
                <source src="https://files.catbox.moe/d13y9l.mp4">
            </video>
        </div>
        <div class="controls">
            <input type="number" id="r-input" value="100">
            <button id="r-btn" class="btn" style="background:var(--blue)" onclick="rocketAction()">–°–¢–ê–í–ö–ê</button>
        </div>
        <div class="history-title">–û–ù–õ–ê–ô–ù –°–¢–ê–í–ö–ò:</div>
        <div id="r-history"></div>
    </div>

    <div id="mines-game" class="game-container">
        <div class="grid" id="m-grid"></div>
        <div class="controls">
            <input type="number" id="m-input" value="100">
            <button id="m-btn" class="btn" style="background:var(--blue)" onclick="minesStart()">–ü–û–ß–ê–¢–ò –ì–†–£</button>
        </div>
    </div>

    <script>
        const socket = io('https://rocket-online-demo.onrender.com');
        let balance = parseFloat(localStorage.getItem('giftup_bal')) || 500;
        let myBet = 0;
        let currentStatus = "WAIT";

        function updateBal() {
            document.querySelectorAll('.bal-txt').forEach(el => el.innerText = balance.toFixed(2));
            localStorage.setItem('giftup_bal', balance);
        }
        updateBal();

        function switchGame(game) {
            document.querySelectorAll('.game-container').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
            document.getElementById(game + '-game').classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // --- ROCKET LOGIC ---
        socket.on('gameTick', (data) => {
            currentStatus = data.gameState;
            const multEl = document.getElementById('r-mult');
            const video = document.getElementById('rocket-vid');
            const btn = document.getElementById('r-btn');

            if (data.gameState === "WAIT") {
                multEl.innerText = data.timer + ".00s";
                multEl.style.color = "white";
                video.style.transform = "translateY(0)";
                video.style.opacity = "1";
                if (myBet === 0) { btn.innerText = "–°–¢–ê–í–ö–ê"; btn.style.background = "var(--blue)"; }
            } else if (data.gameState === "FLY") {
                multEl.innerText = data.multiplier + "x";
                video.play();
                video.style.transform = "translateY(-300px)";
                if (myBet > 0) {
                    btn.innerText = "–ó–ê–ë–†–ê–¢–ò " + (myBet * data.multiplier).toFixed(2);
                    btn.style.background = "var(--green)";
                }
            } else if (data.gameState === "CRASH") {
                multEl.innerText = "BOOM " + data.multiplier + "x";
                multEl.style.color = "var(--red)";
                video.style.opacity = "0";
                myBet = 0;
            }

            if (data.bets) {
                document.getElementById('r-history').innerHTML = data.bets.map(b => `
                    <div class="bet-item"><span>${b.user}</span><span style="color:var(--green)">${b.amount} ‚Ç¥</span></div>
                `).join('');
            }
        });

        function rocketAction() {
            const amt = parseFloat(document.getElementById('r-input').value);
            if (currentStatus === "WAIT" && myBet === 0 && amt <= balance) {
                balance -= amt; myBet = amt; updateBal();
                socket.emit('placeBet', { user: '@tg_player', amount: amt });
                document.getElementById('r-btn').innerText = "–û–ß–Ü–ö–£–í–ê–ù–ù–Ø...";
            } else if (myBet > 0 && currentStatus === "FLY") {
                const m = parseFloat(document.getElementById('r-mult').innerText);
                balance += myBet * m; myBet = 0; updateBal();
                document.getElementById('r-btn').innerText = "–°–¢–ê–í–ö–ê";
                document.getElementById('r-btn').style.background = "var(--blue)";
            }
        }

        // --- MINES LOGIC (Simple Offline for now) ---
        const grid = document.getElementById('m-grid');
        for (let i = 0; i < 25; i++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.onclick = () => { if(cell.innerText === "") cell.innerText = "üíé"; };
            grid.appendChild(cell);
        }
        function minesStart() { alert("–ú—ñ–Ω–∏ –≥–æ—Ç–æ–≤—ñ! –°—Ç–∞–≤ —Ç–∞ —à—É–∫–∞–π –¥—ñ–∞–º–∞–Ω—Ç–∏."); }
    </script>
</body>
</html>
