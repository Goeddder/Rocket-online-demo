<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Giftup Online üöÄ</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        :root { --blue: #007aff; --green: #34c759; --red: #ff3b30; --bg: #000; --panel: #1c1c1e; }
        body { background: var(--bg); color: white; font-family: -apple-system, sans-serif; margin: 0; overflow: hidden; }
        
        .header { padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #222; }
        .balance { background: var(--green); color: black; padding: 6px 15px; border-radius: 20px; font-weight: 800; }

        .viewport { height: 300px; position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        #rocket-vid { width: 220px; position: absolute; bottom: -250px; transition: transform 0.4s, opacity 0.3s; }
        
        .game-ui { padding: 20px; background: #111; border-top: 1px solid #222; border-radius: 20px 20px 0 0; }
        .mult { font-size: 48px; font-weight: 900; text-align: center; margin-bottom: 20px; color: white; }
        
        input { width: 100%; background: #1c1c1e; border: 1px solid #333; border-radius: 12px; padding: 15px; color: white; font-size: 18px; box-sizing: border-box; margin-bottom: 10px; outline: none; }
        .btn { width: 100%; padding: 20px; border-radius: 15px; border: none; font-size: 18px; font-weight: 800; color: white; cursor: pointer; transition: 0.2s; }
        
        .history { padding: 15px; max-height: 200px; overflow-y: auto; }
        .bet-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #111; font-size: 14px; }
        .shake { animation: shake 0.3s; }
        @keyframes shake { 0%, 100% {transform: translate(0);} 25% {transform: translate(5px);} 75% {transform: translate(-5px);} }
    </style>
</head>
<body>

    <div class="header">
        <span>@tg_player</span>
        <div class="balance"><span id="user-balance">500.00</span> ‚Ç¥</div>
    </div>

    <div id="v-port" class="viewport">
        <video id="rocket-vid" playsinline muted loop>
            <source src="https://files.catbox.moe/d13y9l.mp4">
        </video>
    </div>

    <div class="game-ui">
        <div id="main-mult" class="mult">5.00s</div>
        <input type="number" id="bet-input" value="100">
        <button id="action-btn" class="btn" style="background:var(--blue)" onclick="makeBet()">–°–¢–ê–í–ö–ê</button>
    </div>

    <div class="history" id="bet-list">
        <div style="color:#555; font-size:12px; margin-bottom:10px;">–ñ–ò–í–Ü –°–¢–ê–í–ö–ò:</div>
        <div id="bets-container"></div>
    </div>

    <script>
        // –ü–Ü–î–ö–õ–Æ–ß–ï–ù–ù–Ø –î–û –¢–í–û–ì–û –°–ï–†–í–ï–†–ê
        const socket = io('https://rocket-online-demo.onrender.com');

        let balance = parseFloat(localStorage.getItem('giftup_bal')) || 500;
        let myCurrentBet = 0;
        let isWaiting = false;

        function updateBalanceDisplay() {
            document.getElementById('user-balance').innerText = balance.toFixed(2);
            localStorage.setItem('giftup_bal', balance);
        }
        updateBalanceDisplay();

        // –°–õ–£–•–ê–Ñ–ú–û –°–ï–†–í–ï–†
        socket.on('gameTick', (data) => {
            const multText = document.getElementById('main-mult');
            const rocket = document.getElementById('rocket-vid');
            const btn = document.getElementById('action-btn');

            if (data.gameState === "WAIT") {
                multText.innerText = data.timer + ".00s";
                multText.style.color = "white";
                rocket.style.transform = "translateY(0)";
                rocket.style.opacity = "1";
                document.getElementById('v-port').style.background = "transparent";
                
                if (myCurrentBet === 0 && !isWaiting) {
                    btn.innerText = "–°–¢–ê–í–ö–ê";
                    btn.style.background = "var(--blue)";
                }
            } 
            else if (data.gameState === "FLY") {
                multText.innerText = data.multiplier + "x";
                rocket.play();
                rocket.style.transform = "translateY(-350px)";
                
                if (myCurrentBet > 0) {
                    btn.innerText = "–ó–ê–ë–†–ê–¢–ò " + (myCurrentBet * data.multiplier).toFixed(2);
                    btn.style.background = "var(--green)";
                }
            } 
            else if (data.gameState === "CRASH") {
                multText.innerText = "BOOM " + data.multiplier + "x";
                multText.style.color = var(--red);
                rocket.style.opacity = "0";
                rocket.pause();
                document.getElementById('v-port').classList.add('shake');
                setTimeout(() => document.getElementById('v-port').classList.remove('shake'), 400);
                
                myCurrentBet = 0;
                isWaiting = false;
            }

            // –û–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö –≥—Ä–∞–≤—Ü—ñ–≤ (–∫–æ–¥ —Å–µ—Ä–≤–µ—Ä–∞ –º–∞—î –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –º–∞—Å–∏–≤ bets)
            if (data.bets) {
                const container = document.getElementById('bets-container');
                container.innerHTML = data.bets.map(b => `
                    <div class="bet-item">
                        <span>${b.user}</span>
                        <span style="color:var(--green)">${b.amount} ‚Ç¥</span>
                    </div>
                `).join('');
            }
        });

        function makeBet() {
            const amt = parseFloat(document.getElementById('bet-input').value);
            const btn = document.getElementById('action-btn');

            // –Ø–∫—â–æ –Ω–∞—Ç–∏—Å–Ω—É–ª–∏ "–°–¢–ê–í–ö–ê"
            if (myCurrentBet === 0 && amt <= balance && !isWaiting) {
                balance -= amt;
                myCurrentBet = amt;
                isWaiting = true;
                updateBalanceDisplay();
                
                socket.emit('placeBet', { user: '@tg_player', amount: amt });
                
                btn.innerText = "–û–ß–Ü–ö–£–í–ê–ù–ù–Ø...";
                btn.style.background = "#333";
            } 
            // –Ø–∫—â–æ –Ω–∞—Ç–∏—Å–Ω—É–ª–∏ "–ó–ê–ë–†–ê–¢–ò"
            else if (myCurrentBet > 0) {
                const currentMult = parseFloat(document.getElementById('main-mult').innerText);
                const win = myCurrentBet * currentMult;
                balance += win;
                myCurrentBet = 0;
                isWaiting = false;
                updateBalanceDisplay();
                
                btn.innerText = "–í–ò–ì–†–ê–® " + win.toFixed(2);
                btn.style.background = "#555";
            }
        }
    </script>
</body>
</html>
