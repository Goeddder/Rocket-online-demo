<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Giftup Fixed Pro üöÄ</title>
    <style>
        :root { --blue: #007aff; --cyan: #00f2ff; --green: #34c759; --red: #ff3b30; --bg: #000; }
        body { background: #000; color: white; font-family: -apple-system, sans-serif; margin: 0; padding: 0; overflow: hidden; height: 100vh; }
        
        .stars { position: absolute; width: 100%; height: 100%; background: radial-gradient(1px 1px at 10% 20%, #fff, transparent), radial-gradient(1px 1px at 80% 70%, #fff, transparent); background-size: 200px 200px; opacity: 0.3; pointer-events: none; }

        .header { padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #1a1a1a; background: #000; height: 50px; position: relative; z-index: 100; }
        .balance { background: var(--green); color: #000; padding: 5px 12px; border-radius: 20px; font-weight: 800; font-size: 14px; }

        .game-viewport { flex-grow: 1; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; background: radial-gradient(circle at center, #001a33 0%, #000 80%); height: calc(100vh - 280px); }
        
        /* –î–ï–ö–û–† */
        .saturn-deco { position: absolute; width: 300px; height: 300px; pointer-events: none; opacity: 0.5; }
        .planet { position: absolute; top: 50%; left: 50%; width: 70px; height: 70px; background: radial-gradient(circle at 30% 30%, #333, #000); border-radius: 50%; transform: translate(-50%, -50%); }
        .ring { position: absolute; top: 50%; left: 50%; width: 200px; height: 40px; border: 2px solid var(--cyan); border-radius: 50%; transform: translate(-50%, -50%) rotate(-15deg); box-shadow: 0 0 15px var(--cyan); filter: blur(1px); }
        .core-glow { position: absolute; width: 200px; height: 200px; background: var(--blue); filter: blur(70px); opacity: 0.3; border-radius: 50%; animation: pulse 3s infinite alternate; }
        @keyframes pulse { from { transform: scale(1); opacity: 0.2; } to { transform: scale(1.3); opacity: 0.4; } }

        #rocket-v { 
            width: 250px; mix-blend-mode: screen; transform: scale(0); 
            transition: transform 0.4s ease, opacity 0.3s; z-index: 5;
            filter: drop-shadow(0 0 15px var(--cyan));
        }

        /* –Ü–ù–¢–ï–†–§–ï–ô–° */
        .history-section { padding: 8px 10px; background: #000; border-bottom: 1px solid #1a1a1a; display: flex; gap: 8px; overflow-x: auto; }
        .hs-item { background: #111; padding: 5px 12px; border-radius: 6px; font-size: 12px; font-weight: bold; border: 1px solid #222; color: #666; }
        .active-tab { border-color: var(--blue); color: var(--blue); min-width: 50px; text-align: center; }

        .controls { padding: 20px; background: #000; border-top: 1px solid #1a1a1a; }
        input { width: 100%; background: #0a0a0a; border: 1px solid #333; padding: 14px; color: white; border-radius: 12px; font-size: 18px; text-align: center; margin-bottom: 12px; outline: none; box-sizing: border-box; }
        
        .main-btn { 
            width: 100%; padding: 18px; border-radius: 14px; border: none; 
            font-size: 18px; font-weight: 900; color: white; cursor: pointer; 
            text-transform: uppercase; transition: 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }
        .main-btn:active { transform: scale(0.96); }

        .bets-menu { height: 80px; background: #0a0a0a; border-top: 1px solid #1a1a1a; padding: 10px 20px; }
        .bet-row { display: flex; justify-content: space-between; align-items: center; font-size: 14px; }
    </style>
</head>
<body>
    <div class="stars"></div>
    <div class="header">
        <div style="font-weight: 900; letter-spacing: 1px;">GIFTUP</div>
        <div class="balance"><span id="bal-val">500.00</span> ‚Ç¥</div>
    </div>

    <div class="history-section" id="hs-list">
        <div id="live-tab" class="hs-item active-tab">0.0s</div>
    </div>

    <div class="game-viewport">
        <div class="core-glow"></div>
        <div class="saturn-deco">
            <div class="ring"></div>
            <div class="planet"></div>
        </div>
        <video id="rocket-v" playsinline muted loop>
            <source src="https://files.catbox.moe/d13y9l.mp4" type="video/mp4">
        </video>
    </div>

    <div class="controls">
        <input type="number" id="bet-amt" value="100" step="10">
        <button id="action-btn" class="main-btn" style="background: var(--blue);" onclick="handleMainAction()">–°–¢–ê–í–ö–ê</button>
    </div>

    <div class="bets-menu">
        <div id="my-bet-container">
            <div style="color: #444; font-size: 12px; text-align: center; margin-top: 10px;">–°–¢–ê–í–û–ö –ù–ï–ú–ê–Ñ</div>
        </div>
    </div>

    <script>
        let balance = parseFloat(localStorage.getItem('giftup_bal')) || 500.00;
        let myBet = 0;
        let hasWithdrawn = false;
        let lastRoundId = -1;

        const CYCLE_MS = 20000; 
        const WAIT_MS = 6000;  

        function updateBal() {
            document.getElementById('bal-val').innerText = balance.toFixed(2);
            localStorage.setItem('giftup_bal', balance);
        }

        function getCrash(rId) {
            return 1.1 + ((rId * 157) % 45) / 10;
        }

        function handleMainAction() {
            const now = Date.now();
            const ms = now % CYCLE_MS;
            const btn = document.getElementById('action-btn');
            const amt = parseFloat(document.getElementById('bet-amt').value);

            // 1. –°—Ç–∞–≤–∏–º–æ —Å—Ç–∞–≤–∫—É (—Ç—ñ–ª—å–∫–∏ —É —Ñ–∞–∑—ñ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è)
            if (ms < WAIT_MS && myBet === 0) {
                if (amt > balance || amt <= 0) return;
                balance -= amt;
                myBet = amt;
                hasWithdrawn = false;
                updateBal();
                
                document.getElementById('my-bet-container').innerHTML = `
                    <div class="bet-row">
                        <span>üí∞ ${amt} ‚Ç¥</span>
                        <span id="live-bet-status" style="color:var(--cyan); font-weight:bold;">–ß–ï–ö–ê–Ñ–ú–û...</span>
                    </div>`;
                btn.innerText = "–°–¢–ê–í–ö–ê –ü–†–ò–ô–ù–Ø–¢–ê";
                btn.style.background = "#1a1a1a";
                btn.style.color = "#555";
            } 
            // 2. –ó–∞–±–∏—Ä–∞—î–º–æ –≥—Ä–æ—à—ñ (—Ç—ñ–ª—å–∫–∏ –ø—ñ–¥ —á–∞—Å –ø–æ–ª—å–æ—Ç—É)
            else if (ms >= WAIT_MS && myBet > 0 && !hasWithdrawn) {
                const flyTime = (ms - WAIT_MS) / 1000;
                const currentX = 1 + flyTime * 0.15;
                const crashX = getCrash(Math.floor(now / CYCLE_MS));

                if (currentX < crashX) {
                    let win = myBet * currentX;
                    balance += win;
                    hasWithdrawn = true;
                    updateBal();
                    
                    document.getElementById('my-bet-container').innerHTML = `
                        <div class="bet-row">
                            <span>üí∞ ${myBet} ‚Ç¥</span>
                            <span style="color:var(--green); font-weight:900;">+${win.toFixed(0)} ‚Ç¥</span>
                        </div>`;
                    
                    btn.innerText = "–í–ò–ì–†–ê–®: " + win.toFixed(0) + " ‚Ç¥";
                    btn.style.background = var(--green);
                    btn.style.color = "#000";
                    myBet = 0;
                }
            }
        }

        function engine() {
            const now = Date.now();
            const roundId = Math.floor(now / CYCLE_MS);
            const ms = now % CYCLE_MS;
            
            const tab = document.getElementById('live-tab');
            const rocket = document.getElementById('rocket-v');
            const btn = document.getElementById('action-btn');

            // –ù–æ–≤–∏–π —Ä–∞—É–Ω–¥ - —Å–∫–∏–¥–∞–Ω–Ω—è
            if (roundId !== lastRoundId) {
                lastRoundId = roundId;
                myBet = 0;
                hasWithdrawn = false;
                document.getElementById('my-bet-container').innerHTML = '<div style="color: #444; font-size: 12px; text-align: center; margin-top: 10px;">–°–¢–ê–í–û–ö –ù–ï–ú–ê–Ñ</div>';
            }

            const crashX = getCrash(roundId);
            const crashMs = (crashX - 1) / 0.15 * 1000;

            if (ms < WAIT_MS) {
                // –û–ß–Ü–ö–£–í–ê–ù–ù–Ø
                tab.innerText = ((WAIT_MS - ms) / 1000).toFixed(1) + "s";
                tab.style.color = "var(--blue)";
                rocket.style.transform = "scale(0)";
                rocket.pause();
                
                if (myBet === 0) {
                    btn.innerText = "–°–¢–ê–í–ö–ê";
                    btn.style.background = "var(--blue)";
                    btn.style.color = "white";
                }
            } 
            else if (ms < WAIT_MS + crashMs) {
                // –ü–û–õ–Ü–¢
                const currentX = (1 + ((ms - WAIT_MS) / 1000) * 0.15).toFixed(2);
                tab.innerText = currentX + "x";
                tab.style.color = "var(--green)";
                rocket.style.transform = "scale(1)";
                rocket.style.opacity = "1";
                if (rocket.paused) rocket.play();

                if (myBet > 0 && !hasWithdrawn) {
                    btn.innerText = "–ó–ê–ë–†–ê–¢–ò " + (myBet * currentX).toFixed(0);
                    btn.style.background = "var(--green)";
                    btn.style.color = "#000";
                    const lb = document.getElementById('live-bet-status');
                    if(lb) lb.innerText = currentX + "x";
                }
            } 
            else {
                // –ö–†–ê–®
                tab.innerText = crashX.toFixed(2) + "x";
                tab.style.color = "var(--red)";
                rocket.style.opacity = "0";
                
                if (myBet > 0 && !hasWithdrawn) {
                    btn.innerText = "BOOM!";
                    btn.style.background = "var(--red)";
                    btn.style.color = "white";
                    const lb = document.getElementById('live-bet-status');
                    if(lb) { lb.innerText = "CRASH"; lb.style.color = "var(--red)"; }
                }
            }
        }

        setInterval(engine, 50);
        updateBal();
    </script>
</body>
</html>
